@inherits LayoutComponentBase

<HLoader />
<AuthorizeView>
    <Authorized>
        <!-- Navbar -->
        <div class="sticky-top">
            <header class="navbar navbar-expand-md sticky-top d-print-none">
                <div class="container-fluid">
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3">
                        <a href="/" class="d-flex align-items-center text-decoration-none">
                            <img src="../assets/SM.png" width="110" height="32" alt="HSystem" class="navbar-brand-image">
                        </a>
                    </h1>
                    <div class="navbar-nav flex-row order-md-last">
                        <div class="d-none d-md-flex">
                            <a href="/index?theme=dark" class="nav-link px-0 hide-theme-dark" title="Enable dark mode" data-bs-toggle="tooltip"
                               data-bs-placement="bottom">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" /></svg>
                            </a>
                            <a href="/index?theme=light" class="nav-link px-0 hide-theme-light" title="Enable light mode" data-bs-toggle="tooltip"
                               data-bs-placement="bottom">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" /><path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7" /></svg>
                            </a>
                            <div class="nav-item dropdown d-none d-md-flex me-1">
                                <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="Show notifications">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6" /><path d="M9 17v1a3 3 0 0 0 6 0v-1" /></svg>
                                 @*   <span class="@(ListShedulers != null && ListShedulers.Any() ? "badge bg-red" : "")"></span>*@
                                </a>
                               
                            </div>
                        </div>
                        <div class="nav-item dropdown">
                            <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                                <img src="../assets/user.png" width="110" height="32" alt="HSystem" class="navbar-brand-image">
                                <div class="d-none d-xl-block ps-2">
                                    <div style="font-size: 13px;">@FullName</div>
                                    <div class="mt-1 text-muted" style="font-size: 11px;">@RoleName</div>
                                </div>
                            </a>
                            <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                                <a onclick="@(()=> OnOpenDialogHandler())" class="dropdown-item">Thay đổi mật khẩu</a>
                                <a href="/logout" class="dropdown-item">Đăng xuất</a>
                            </div>
                        </div> 
                    </div>
                </div>
            </header>
            <header class="navbar-expand-md">
                <div class="collapse navbar-collapse" id="navbar-menu">
                    <div class="navbar">
                        <div class="container-fluid">
                            <ul class="navbar-nav">
                                <li class="nav-item @(PageActive == "/index" ||  PageActive == "/" ? "active": "")">
                                    <a class="nav-link" href="index">
                                        <span class="nav-link-icon d-md-none d-lg-inline-block">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
                                                <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
                                                <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
                                            </svg>
                                        </span>
                                        <span class="nav-link-title">
                                            Trang chủ
                                        </span>
                                    </a>
                                </li>
                                <li class="nav-item @(PageActive == "/customer" ||  PageActive == "/" ? "active": "")">
                                    <a class="nav-link" href="customer">
                                        <span class="nav-link-icon d-md-none d-lg-inline-block">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <path d="M10 13a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
                                                <path d="M8 21v-1a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v1" />
                                                <path d="M15 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
                                                <path d="M17 10h2a2 2 0 0 1 2 2v1" />
                                                <path d="M5 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
                                                <path d="M3 13v-1a2 2 0 0 1 2 -2h2" />
                                            </svg>

                                            
                                        </span>
                                        <span class="nav-link-title">
                                            Khách hàng
                                        </span>
                                    </a>
                                </li>
                                @if(pIsAdmin){
                                    
                                <li class="nav-item @(PageActive == "/user" ||  PageActive == "/" ? "active": "")">
                                    <a class="nav-link" href="user">
                                        <span class="nav-link-icon d-md-none d-lg-inline-block">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <path d="M5 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" />
                                                <path d="M3 21v-2a4 4 0 0 1 4 -4h4c.96 0 1.84 .338 2.53 .901" />
                                                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                                                <path d="M16 19h6" />
                                                <path d="M19 16v6" />
                                            </svg>
                                        </span>
                                        <span class="nav-link-title">
                                            Nhân viên
                                        </span>
                                    </a>
                                </li>
                                 <li class="nav-item @(PageActive == "/product" ||  PageActive == "/" ? "active": "")">
                                    <a class="nav-link" href="product">
                                        <span class="nav-link-icon d-md-none d-lg-inline-block">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-card-list" viewBox="0 0 16 16">
                                              <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z"/>
                                              <path d="M5 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 5 8m0-2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m0 5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m-1-5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0M4 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0m0 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0"/>
                                            </svg>
                                        </span>
                                        <span class="nav-link-title">
                                            Sản phẩm
                                        </span>
                                    </a>
                                </li>
                                 <li class="nav-item @(PageActive == "/department" ||  PageActive == "/" ? "active": "")">
                                    <a class="nav-link" href="department">
                                        <span class="nav-link-icon d-md-none d-lg-inline-block">
                                           <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-door-open" viewBox="0 0 16 16">
                                              <path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1"/>
                                              <path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117M11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5M4 1.934V15h6V1.077z"/>
                                            </svg>
                                        </span>
                                        <span class="nav-link-title">
                                            Bộ phận
                                        </span>
                                    </a>
                                </li>
                                }
                                
                            </ul>
                        </div>
                    </div>
                </div>
            </header>
        </div>
        
       <div class="page-wrapper" style="margin: 4px 2px 2px 2px">
           <TelerikRootComponent>
               <HBreadcrumb Breadcrumbs="@ListBreadcrumbs" />
               <CascadingValue Value="@BreadcrumbsHandler">
                   @Body
               </CascadingValue>
               <HToast />
           </TelerikRootComponent>
        </div>
    </Authorized>
    <NotAuthorized>
        <SM.WEB.Features.Pages.RedirectToLogin />
    </NotAuthorized>
</AuthorizeView>

@*Thay đổi thông tin cá nhân*@
<HDialog @bind-IsVisible="@IsShowDialogProfile"
         SaveAndClosed="@(()=> SaveDataHandler())"
         IsShowButtonSaveAdnCreate="false"
         Title="Thay đổi mật khẩu">
    <EditForm EditContext="@_EditProfileContext">
        <DataAnnotationsValidator />
        <div>
            <HLabel Value="Mã người dùng:"/>
            <TelerikTextBox @bind-Value="@UserUpdate!.EmpNo" Class="h-link" Enabled="false"  />
        </div>
        <div class="mt-2">
            <HLabel For="txtFullName" Value="Họ tên người dùng:" />
            <TelerikTextBox @bind-Value="@UserUpdate.FullName" Id="txtFullName" Enabled="false" />
        </div>
        <div class="mt-2">
            <HLabel For="txtUserName" Value="Tên đăng nhập:"/>
            <TelerikTextBox @bind-Value="@UserUpdate.UserName" Id="txtUserName" Enabled="false" />
        </div>
        <div class="mt-2">
            <HLabel For="txtPassWord" Value="Mật khẩu hiện tại:" IsRequired="true" />
            <div style="display: flex">
                <TelerikTextBox Password="@isPasswordHidden" @bind-Value="@UserUpdate.Password" Id="txtPassWord" />
                <i @onclick="@(() => HiddenPassword())" class="@(isPasswordHidden ? "fa fa-eye-slash":"far fa-eye")" id="togglePassword" style="margin-left: 5px; margin-top:7px; cursor: pointer;"></i>  
            </div>
            <HValidationTooltip ValidationFor="@(()=> UserUpdate.Password)" Id="txtPassWord" />
        </div>
         <div class="mt-2">
            <HLabel For="txtPassWordNew" Value="Mật khẩu mới:" IsRequired="true" />
            <div style="display: flex">
                <TelerikTextBox Password="@isReEnterPasswordAgainHidden" @bind-Value="@UserUpdate.PasswordNew" Id="txtPassWord" />
                <i @onclick="@(() => HiddenReEnterPassword())" class="@(isReEnterPasswordAgainHidden ? "fa fa-eye-slash":"far fa-eye")" id="togglePassword" style="margin-left: 5px;margin-top:7px; cursor: pointer;"></i>  
            </div>
            <HValidationTooltip ValidationFor="@(()=> UserUpdate.PasswordNew)" Id="txtPassWordNew" />
        </div>
        <div class="mt-2">
            <HLabel For="txtRePassWordNew" Value="Nhập lại mật khẩu mới:" IsRequired="true" />
            <div style="display: flex">
                <TelerikTextBox Password="@isReEnterPasswordAgainHidden" @bind-Value="@UserUpdate.ReEnterPasswordNew" Id="txtPassWord" />
                <i @onclick="@(() => HiddenReEnterPassword())" class="@(isReEnterPasswordAgainHidden ? "fa fa-eye-slash":"far fa-eye")" id="togglePassword" style="margin-left: 5px;margin-top:7px; cursor: pointer;"></i>  
            </div>
            <HValidationTooltip ValidationFor="@(()=> UserUpdate.ReEnterPasswordNew)" Id="txtRePassWordNew" />
        </div> 
    </EditForm>
</HDialog>

<HConfirm @ref="@_rDialogProfiles" />
@code {
    private bool isPasswordHidden = true;
     private bool isReEnterPasswordAgainHidden = true;

    private void HiddenPassword()
    {
        isPasswordHidden = !isPasswordHidden;
    }

     private void HiddenReEnterPassword()
    {
        isReEnterPasswordAgainHidden = !isReEnterPasswordAgainHidden;
    }
}